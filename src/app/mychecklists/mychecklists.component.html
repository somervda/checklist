<app-header name="My Checklists"></app-header>
<div class="container">
  <span class="pt-1 pb-0">Owner</span>
  <select
    class="dropdown form-control"
    (change)="changeOwnership()"
    [(ngModel)]="selectedOwnership"
  >
    <option value="All" selected>All : Owned by me or my communities</option>
    <option value="Owned" selected>Owned by me</option>
    <option
      *ngFor="let community of auth.user.communitiesAsArray"
      value="{{ community.id }}"
      >{{ community.name }}</option
    >
  </select>
  <br />
  <span class="pt-1 pb-0">Status</span>
  <select
    class="dropdown  form-control"
    (change)="filterByStatus()"
    [(ngModel)]="selectedStatus"
  >
    <option value="-1" selected>All</option>
    <option
      *ngFor="let status of checklistStatusAsArray"
      value="{{ status.id }}"
      >{{ status.name }}</option
    >
  </select>

  <div class="row mx-1">
    <!--
      Datatable - see https://swimlane.gitbook.io/ngx-datatable/api/table/inputs
    -->
    <ngx-datatable
      class="bootstrap ngx-datatable"
      [columnMode]="'flex'"
      [rows]="checklists$ | async"
      [loadingIndicator]="true"
      [rowHeight]="35"
      [footerHeight]="50"
      [limit]="20"
      style="width: 100%"
      [sorts]="[
        {
          prop: 'title',
          dir: 'asc'
        }
      ]"
    >
      <ngx-datatable-column name="Name" [flexGrow]="3" [sortable]="false">
        <ng-template
          let-row="row"
          let-value="value"
          ngx-datatable-cell-template
        >
          <span class="mx-1"
            ><a routerLink="/checklist/{{ row.id }}">{{ row.title }}</a></span
          >
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="Status" [flexGrow]="1">
        <ng-template
          let-row="row"
          let-value="value"
          ngx-datatable-cell-template
        >
          {{ ChecklistStatus[row.status] }}
        </ng-template>
      </ngx-datatable-column>

      <ngx-datatable-column name="Ownership" [flexGrow]="1">
        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template
          ><span *ngIf="row?.owner?.uid == auth.getUserUID">
            <i
              class="fas fa-user mr-2"
              placement="top"
              ngbTooltip="Owner: {{ row?.owner?.displayName }}"
              style="color: blue"
            ></i
          ></span>
          <span *ngIf="row?.owner?.uid != auth.getUserUID">
            <i
              class="fas fa-user mr-2"
              placement="top"
              ngbTooltip="Owner: {{ row?.owner?.displayName }}"
              style="color: skyblue"
            ></i
          ></span>
          <span *ngIf="row.community">
            <span *ngIf="row.community?.communityId == selectedCommunity">
              <i
                class="fas fa-users mr-2"
                placement="top"
                ngbTooltip="Community: {{ row?.community?.name }}"
                style="color:maroon"
              ></i
            ></span>
            <span *ngIf="row.community?.communityId != selectedCommunity">
              <i
                class="fas fa-users mr-2"
                placement="top"
                ngbTooltip="Community: {{ row?.community?.name }}"
                style="color:lightcoral"
              ></i></span
          ></span>
        </ng-template>
      </ngx-datatable-column>
    </ngx-datatable>
  </div>
  <div
    class="bg-light border-black border mt-1 mx-1 p-1 rounded text-black-50 text-center"
    style="font-size: 70%"
  >
    <i class="fas fa-user" style="color: blue; font-size: 70%;"></i> Owned by
    current user
    <i class="fas fa-user " style="color: skyblue; font-size: 70%;"></i> Owned
    by a different user
    <i class="fas fa-users" style="color: maroon; font-size: 70%;"></i> Member
    of one of my communities
    <i class="fas fa-users" style="color:lightcoral; font-size: 70%;"></i>
    Member of another community
  </div>
</div>
